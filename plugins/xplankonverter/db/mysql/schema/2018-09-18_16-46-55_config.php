<?

$constants = array (
  'XPLANKONVERTER_FILE_PATH' => 
  array (
    'name' => 'XPLANKONVERTER_FILE_PATH',
    'value' => 'xplankonverter/',
    'prefix' => 'UPLOADPATH',
    'type' => 'string',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_SHAPE_PATH' => 
  array (
    'name' => 'XPLANKONVERTER_SHAPE_PATH',
    'value' => 'xplanshapes/',
    'prefix' => 'UPLOADPATH',
    'type' => 'string',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_KONVERTIERUNGEN_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_KONVERTIERUNGEN_LAYER_ID',
    'value' => '8',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_SHAPEFILES_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_SHAPEFILES_LAYER_ID',
    'value' => '10',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_BP_PLAENE_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_BP_PLAENE_LAYER_ID',
    'value' => '20',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_FP_PLAENE_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_FP_PLAENE_LAYER_ID',
    'value' => '22',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_SO_PLAENE_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_SO_PLAENE_LAYER_ID',
    'value' => '24',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_RP_PLAENE_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_RP_PLAENE_LAYER_ID',
    'value' => '26',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_XP_PLAENE_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_XP_PLAENE_LAYER_ID',
    'value' => '0',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_BP_BEREICHE_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_BP_BEREICHE_LAYER_ID',
    'value' => '19',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_FP_BEREICHE_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_FP_BEREICHE_LAYER_ID',
    'value' => '21',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_SO_BEREICHE_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_SO_BEREICHE_LAYER_ID',
    'value' => '23',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_RP_BEREICHE_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_RP_BEREICHE_LAYER_ID',
    'value' => '13',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_XP_BEREICHE_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_XP_BEREICHE_LAYER_ID',
    'value' => '0',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_REGELN_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_REGELN_LAYER_ID',
    'value' => '9',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_VALIDIERUNGSERGEBNISSE_LAYER_ID' => 
  array (
    'name' => 'XPLANKONVERTER_VALIDIERUNGSERGEBNISSE_LAYER_ID',
    'value' => '455',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'GML_LAYER_TEMPLATE_GROUP' => 
  array (
    'name' => 'GML_LAYER_TEMPLATE_GROUP',
    'value' => '10004',
    'prefix' => '',
    'type' => 'numeric',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_CONTENT_SCHEMA' => 
  array (
    'name' => 'XPLANKONVERTER_CONTENT_SCHEMA',
    'value' => 'xplan_gml',
    'prefix' => '',
    'type' => 'string',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLANKONVERTER_INSPIRE_KONVERTER' => 
  array (
    'name' => 'XPLANKONVERTER_INSPIRE_KONVERTER',
    'value' => 'false',
    'prefix' => '',
    'type' => 'boolean',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLAN_NS_PREFIX' => 
  array (
    'name' => 'XPLAN_NS_PREFIX',
    'value' => 'xplan',
    'prefix' => '',
    'type' => 'string',
    'description' => 'Konstanten fuer GML-Builder
XML-namespace
',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLAN_NS_URI' => 
  array (
    'name' => 'XPLAN_NS_URI',
    'value' => 'http://www.xplanung.de/xplangml/5/0',
    'prefix' => '',
    'type' => 'string',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLAN_NS_SCHEMA_LOCATION' => 
  array (
    'name' => 'XPLAN_NS_SCHEMA_LOCATION',
    'value' => 'http://www.xplanungwiki.de/upload/XPlanGML/5.0/Schema/XPlanung-Operationen.xsd',
    'prefix' => '',
    'type' => 'string',
    'description' => '',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
  'XPLAN_MAX_NESTING_DEPTH' => 
  array (
    'name' => 'XPLAN_MAX_NESTING_DEPTH',
    'value' => '3',
    'prefix' => '',
    'type' => 'numeric',
    'description' => 'max Rekursionstiefe für Nested Composite Types
',
    'group' => 'Plugins/xplankonverter',
    'plugin' => 'xplankonverter',
    'saved' => 0,
  ),
);

$config_file = PLUGINS.'xplankonverter/config/config.php';
if(file_exists($config_file)){
	$own_constants = $this->get_constants_from_config(file($config_file), 'xplankonverter');
	foreach($constants as &$constant){
		if(array_key_exists($constant['name'], $own_constants)){
			$constant['value'] = $own_constants[$constant['name']]['value'];
			$constant['saved'] = 1;
		}
	}
}

$sql = "SELECT * FROM config WHERE plugin = 'xplankonverter'";
$result=$this->database->execSQL($sql,0, 0);
if($result[0]){
	echo '<br>Fehler bei der Abfrage der Tabelle config.<br>';
}
else{
	if(mysql_num_rows($result[1]) == 0){
		$sql = '';
		foreach($constants as $constant){
			$sql.="INSERT INTO config (name, prefix, value, description, type, `group`, `plugin`, `saved`) VALUES ('".$constant['name']."', '".$constant['prefix']."', '".addslashes($constant['value'])."', '".addslashes($constant['description'])."', '".$constant['type']."', '".$constant['group']."', '".$constant['plugin']."', ".$constant['saved'].");\n";
		}
		# config Tabelle befüllen
		$result = $this->database->exec_commands($sql, NULL, NULL);
	}
}

if($result[0] == 0){
	# config.php schreiben
	$result = $this->write_config_file('xplankonverter');
}

?>
